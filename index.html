<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Precision Rounding Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333333;
            padding: 20px;
            transition: all 0.3s ease;
            margin: 0;
            min-height: 100vh;
            position: relative;
        }

        body.dark-mode {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        .tool-description {
            width: 300px;
            padding: 20px;
            background-color: rgba(107, 91, 149, 0.1);
            border-radius: 15px;
            font-size: 16px;
            line-height: 1.8;
            height: fit-content;
            position: absolute;
            cursor: move;
            user-select: none;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 2px 10px rgba(107, 91, 149, 0.2);
            z-index: 1000;
            top: 100px;
            left: 50px;
        }

        .tool-description:hover {
            box-shadow: 0 4px 15px rgba(107, 91, 149, 0.3);
        }

        .tool-description h3 {
            color: #6b5b95;
            font-size: 20px;
            margin-bottom: 15px;
        }

        body.dark-mode .tool-description {
            background-color: rgba(143, 127, 184, 0.1);
        }

        body.dark-mode .tool-description h3 {
            color: #8f7fb8;
        }

        .main-content {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        h1 {
            color: #6b5b95;
            font-size: 36px;
            text-align: center;
            margin-bottom: 30px;
        }

        body.dark-mode h1 {
            color: #8f7fb8;
        }

        .container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(107, 91, 149, 0.1);
        }

        body.dark-mode .container {
            background-color: #2d2d2d;
            box-shadow: 0 4px 15px rgba(107, 91, 149, 0.3);
        }

        .file-upload-container {
            text-align: center;
            padding: 30px;
            border: 3px dashed #6b5b95;
            border-radius: 10px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        body.dark-mode .file-upload-container {
            border-color: #8f7fb8;
        }

        .file-upload-container:hover {
            border-color: #ff6f61;
            background-color: rgba(107, 91, 149, 0.1);
        }

        .file-upload-label {
            display: block;
            font-size: 18px;
            margin-bottom: 15px;
            color: #6b5b95;
            cursor: pointer;
        }

        body.dark-mode .file-upload-label {
            color: #8f7fb8;
        }

        #fileInput {
            display: none;
        }

        .upload-icon {
            font-size: 40px;
            color: #6b5b95;
            margin-bottom: 15px;
        }

        body.dark-mode .upload-icon {
            color: #8f7fb8;
        }

        #output {
            background-color: #f8f9fa;
            padding: 25px;
            margin-top: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            color: #015d00;
            font-size: 16px;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        body.dark-mode #output {
            background-color: #363636;
            color: #00ff00;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 32px;
            cursor: pointer;
            color: #6b5b95;
            padding: 15px;
            border-radius: 50%;
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .theme-toggle:hover {
            color: #ff6f61;
        }

        body.dark-mode .theme-toggle {
            color: #8f7fb8;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6b5b95;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        body.dark-mode .spinner {
            border-color: #2d2d2d;
            border-top-color: #8f7fb8;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(107, 91, 149, 0.1);
            border-left: 4px solid #6b5b95;
        }

        body.dark-mode .result-item {
            background-color: #404040;
            box-shadow: 0 2px 5px rgba(107, 91, 149, 0.3);
            border-left-color: #8f7fb8;
        }
    </style>
</head>
<body>
    <div class="tool-description">
        <h3>Tool Description</h3>
        <p>This tool processes CSV or TXT files containing decimal numbers. It accepts numbers with any number of decimal places and rounds them according to specific rules. Single decimal numbers remain unchanged, while numbers with two or more decimal places are rounded appropriately.</p>
    </div>

    <div class="main-content">
        <button class="theme-toggle" onclick="toggleDarkMode()">
            <i class="fas fa-sun"></i>
        </button>

        <h1>Precision Rounding Assistant</h1>
        <div class="container">
            <div class="file-upload-container" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                <label class="file-upload-label">
                    Click to upload CSV or TXT file
                </label>
                <input type="file" id="fileInput" accept=".csv,.txt" />
            </div>

            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Processing file...</p>
            </div>

            <div id="output"></div>
        </div>
    </div>

    <script>
        document.getElementById("fileInput").addEventListener("change", handleFileSelect);

        const dragElement = document.querySelector('.tool-description');
        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

        dragElement.onmousedown = dragMouseDown;

        function dragMouseDown(e) {
            e.preventDefault();
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
            e.preventDefault();
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;

            let newTop = dragElement.offsetTop - pos2;
            let newLeft = dragElement.offsetLeft - pos1;

            const maxX = window.innerWidth - dragElement.offsetWidth;
            const maxY = window.innerHeight - dragElement.offsetHeight;

            newTop = Math.min(Math.max(0, newTop), maxY);
            newLeft = Math.min(Math.max(0, newLeft), maxX);

            dragElement.style.top = newTop + "px";
            dragElement.style.left = newLeft + "px";
        }

        function closeDragElement() {
            document.onmouseup = null;
            document.onmousemove = null;
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            document.querySelector('.loading-spinner').style.display = 'block';
            document.getElementById("output").style.display = 'none';

            const reader = new FileReader();
            reader.onload = function(e) {
                const contents = e.target.result;
                setTimeout(() => processFileContents(contents, file.name), 1000);
            };
            reader.readAsText(file);
        }

        function processFileContents(contents, fileName) {
            const lines = contents.split(/\r?\n/).filter(line => line.trim() !== '');
            let output = "";
            const isCSV = fileName.toLowerCase().endsWith(".csv");

            for (let line of lines) {
                const values = isCSV ? line.split(",") : [line];
                for (let value of values) {
                    value = value.trim();
                    if (isValidFloat(value)) {
                        const originalNumber = parseFloat(value);
                        const rounded = roundNumber(originalNumber);
                        output += `<div class="result-item">Original: ${value} â†’ Rounded: ${rounded.toFixed(2)}</div>`;
                    }
                }
            }

            document.querySelector('.loading-spinner').style.display = 'none';
            const outputElement = document.getElementById("output");
            outputElement.innerHTML = output || "<div class='result-item'>No valid float numbers found.</div>";
            outputElement.style.display = 'block';
        }

        function isValidFloat(value) {
            return /^\d+\.\d+$/.test(value);
        }

        function roundNumber(num) {
            const parts = num.toString().split(".");
            if (parts.length === 1) {
                return num;
            }
            
            if (parts[1].length === 1) {
                return num;
            } else if (parts[1].length === 2) {
                const hundredths = parseInt(parts[1][1]);
                if (hundredths >= 5) {
                    return Math.ceil(num * 10) / 10;
                } else {
                    return Math.floor(num * 10) / 10;
                }
            } else {
                return Math.round(num * 100) / 100;
            }
        }

        function toggleDarkMode() {
            document.body.classList.toggle("dark-mode");
            const icon = document.querySelector('.theme-toggle i');
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            } else {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            }
        }
    </script>
</body>
</html>
